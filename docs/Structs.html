<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Structures  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a name="//apple_ref/swift/Section/Structures" class="dashAnchor"></a>
    <a title="Structures  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Tomorrowland Docs</a> (100% documented)</p>
        <p class="header-right"><a href="https://github.com/lilyball/Tomorrowland"><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Tomorrowland Reference</a>
        <img id="carat" src="img/carat.png" />
        Structures  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/NoError.html">NoError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/PromiseCallbackError.html">PromiseCallbackError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/PromiseContext.html">PromiseContext</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/PromiseResult.html">PromiseResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/PromiseTimeoutError.html">PromiseTimeoutError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when5first15cancelRemainingAA7PromiseVyxq_GSayAGG_Sbtr0_lF">when(first:cancelRemaining:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled_____3qos15cancelOnFailureAA7PromiseVyx_q_q0_q1_q2_q3_tq4_GAGyxq4_G_AGyq_q4_GAGyq0_q4_GAGyq1_q4_GAGyq2_q4_GAGyq3_q4_G8Dispatch0I3QoSV0J6SClassOSbtr5_lF">when(fulfilled:_:_:_:_:_:qos:cancelOnFailure:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled____3qos15cancelOnFailureAA7PromiseVyx_q_q0_q1_q2_tq3_GAGyxq3_G_AGyq_q3_GAGyq0_q3_GAGyq1_q3_GAGyq2_q3_G8Dispatch0I3QoSV0J6SClassOSbtr4_lF">when(fulfilled:_:_:_:_:qos:cancelOnFailure:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled___3qos15cancelOnFailureAA7PromiseVyx_q_q0_q1_tq2_GAGyxq2_G_AGyq_q2_GAGyq0_q2_GAGyq1_q2_G8Dispatch0I3QoSV0J6SClassOSbtr3_lF">when(fulfilled:_:_:_:qos:cancelOnFailure:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled__3qos15cancelOnFailureAA7PromiseVyx_q_q0_tq1_GAGyxq1_G_AGyq_q1_GAGyq0_q1_G8Dispatch0I3QoSV0J6SClassOSbtr2_lF">when(fulfilled:_:_:qos:cancelOnFailure:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled_3qos15cancelOnFailureAA7PromiseVyx_q_tq0_GAGyxq0_G_AGyq_q0_G8Dispatch0I3QoSV0J6SClassOSbtr1_lF">when(fulfilled:_:qos:cancelOnFailure:)</a>
              </li>
              <li class="nav-group-task">
                <a href="Functions.html#/s:12Tomorrowland4when9fulfilled3qos15cancelOnFailureAA7PromiseVySayxGq_GSayAGyxq_GG_8Dispatch0I3QoSV0J6SClassOSbtr0_lF">when(fulfilled:qos:cancelOnFailure:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/DelayedPromise.html">DelayedPromise</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Promise.html">Promise</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/Promise/Resolver.html">– Resolver</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/PromiseCancellable.html">PromiseCancellable</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/PromiseInvalidationToken.html">PromiseInvalidationToken</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TokenPromise.html">TokenPromise</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:12Tomorrowland17StdDelayedPromisea">StdDelayedPromise</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:12Tomorrowland10StdPromisea">StdPromise</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            <h1>Structures</h1>
            <p>The following structures are available globally.</p>

          </section>
          <section class="section task-group-section">
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:12Tomorrowland14DelayedPromiseV"></a>
                    <a name="//apple_ref/swift/Struct/DelayedPromise" class="dashAnchor"></a>
                    <a class="token" href="#/s:12Tomorrowland14DelayedPromiseV">DelayedPromise</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p><code>DelayedPromise</code> is like a <code><a href="Structs/Promise.html">Promise</a></code> but it doesn&rsquo;t invoke its callback until the <code>.promise</code>
variable is accessed.</p>

<p>The purpose of <code>DelayedPromise</code> is to allow functions to return calculations that aren&rsquo;t
performed if they&rsquo;re not needed.</p>

<p>Example:</p>
<pre class="highlight swift"><code><span class="kd">func</span> <span class="nf">getUserInfo</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">avatar</span><span class="p">:</span> <span class="kt">DelayedPromise</span><span class="o">&lt;</span><span class="kt">UIImage</span><span class="p">,</span><span class="kt">Error</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="err">…</span>
<span class="p">}</span>

<span class="k">let</span> <span class="p">(</span><span class="nv">name</span><span class="p">,</span> <span class="nv">avatar</span><span class="p">)</span> <span class="o">=</span> <span class="nf">getUserInfo</span><span class="p">()</span>
<span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">name</span>
<span class="n">avatar</span><span class="o">.</span><span class="n">promise</span><span class="o">.</span><span class="n">then</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="p">(</span><span class="n">image</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">imageView</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span>
<span class="p">}</span>
</code></pre>

                        <a href="Structs/DelayedPromise.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">DelayedPromise</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:12Tomorrowland7PromiseV"></a>
                    <a name="//apple_ref/swift/Struct/Promise" class="dashAnchor"></a>
                    <a class="token" href="#/s:12Tomorrowland7PromiseV">Promise</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code>Promise</code> is a construct that will eventually hold a value or error, and can invoke callbacks
when that happens.</p>

<p>Example usage:</p>
<pre class="highlight swift"><code><span class="kt">Promise</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="o">.</span><span class="n">utility</span><span class="p">)</span> <span class="p">{</span> <span class="n">resolver</span> <span class="k">in</span>
    <span class="k">let</span> <span class="nv">value</span> <span class="o">=</span> <span class="k">try</span> <span class="nf">someLongComputation</span><span class="p">()</span>
    <span class="n">resolver</span><span class="o">.</span><span class="nf">fulfill</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">value</span><span class="p">)</span>
<span class="p">}</span><span class="o">.</span><span class="nf">then</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">main</span><span class="p">)</span> <span class="p">{</span> <span class="n">value</span> <span class="k">in</span>
    <span class="k">self</span><span class="o">.</span><span class="nf">updateUI</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">value</span><span class="p">)</span>
<span class="p">}</span><span class="o">.</span><span class="nf">catch</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="o">.</span><span class="n">main</span><span class="p">)</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="k">self</span><span class="o">.</span><span class="nf">handleError</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
<span class="p">}</span>
</code></pre>

<p>Promises can also be cancelled. With a <code>Promise</code> object you can invoke <code>.requestCancel()</code>, which
is merely advisory; the promise does not have to actually implement cancellation and may resolve
anyway. But if a promise does implement cancellation, it can then call <code>resolver.cancel()</code>. Note
that even if the promise supports cancellation, calling <code>.requestCancel()</code> on an unresolved
promise does not guarantee that it will cancel, as the promise may be in the process of
resolving when that method is invoked. Make sure to use the invalidation token support if you
need to ensure your registered callbacks aren&rsquo;t invoked past a certain point.</p>

                        <a href="Structs/Promise.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">Promise</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:12Tomorrowland18PromiseCancellableV"></a>
                    <a name="//apple_ref/swift/Struct/PromiseCancellable" class="dashAnchor"></a>
                    <a class="token" href="#/s:12Tomorrowland18PromiseCancellableV">PromiseCancellable</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A type that can be used to cancel a promise without holding onto the full promise.</p>

<p>In particular, this acts like a weak reference, allowing for cancelling the promise without
creating a retain cycle. Promise retain cycles normally break themselves anyway when the promise
is resolved, but a misbehaving promise body may drop the resolver without ever resolving the
promise. If the <code><a href="Structs/Promise.html">Promise</a></code> has no more references to it this automatically cancels the
promise, but a retain cycle prevents this.</p>

<p>This is returned from <code><a href="Structs/Promise.html#/s:12Tomorrowland7PromiseV11cancellableAA0B11CancellableVvp">Promise.cancellable</a></code>.</p>

                        <a href="Structs/PromiseCancellable.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">PromiseCancellable</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:12Tomorrowland24PromiseInvalidationTokenV"></a>
                    <a name="//apple_ref/swift/Struct/PromiseInvalidationToken" class="dashAnchor"></a>
                    <a class="token" href="#/s:12Tomorrowland24PromiseInvalidationTokenV">PromiseInvalidationToken</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>An invalidation token that can be used to cancel callbacks registered to a <code><a href="Structs/Promise.html">Promise</a></code>.</p>

                        <a href="Structs/PromiseInvalidationToken.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">PromiseInvalidationToken</span> <span class="p">:</span> <span class="kt">CustomStringConvertible</span><span class="p">,</span> <span class="kt">CustomDebugStringConvertible</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
            <div class="task-group">
              <ul>
                <li class="item">
                  <div>
                    <code>
                    <a name="/s:12Tomorrowland12TokenPromiseV"></a>
                    <a name="//apple_ref/swift/Struct/TokenPromise" class="dashAnchor"></a>
                    <a class="token" href="#/s:12Tomorrowland12TokenPromiseV">TokenPromise</a>
                    </code>
                  </div>
                  <div class="height-container">
                    <div class="pointer-container"></div>
                    <section class="section">
                      <div class="pointer"></div>
                      <div class="abstract">
                        <p>A <code><a href="Structs/Promise.html">Promise</a></code> adapter that automatically applies a <code><a href="Structs/PromiseInvalidationToken.html">PromiseInvalidationToken</a></code>.</p>

<p>This exposes the same methods as <code><a href="Structs/Promise.html">Promise</a></code> but it always passes a given
<code><a href="Structs/PromiseInvalidationToken.html">PromiseInvalidationToken</a></code> to the underlying promise.</p>
<div class="aside aside-important">
    <p class="aside-title">Important</p>
    <code>TokenPromise</code> automatically cancels any returned child <code><a href="Structs/Promise.html">Promise</a></code>s when the
<code><a href="Structs/PromiseInvalidationToken.html">PromiseInvalidationToken</a></code> is invalidated. The only exception is <code><a href="Structs/Promise.html">Promise</a></code>s returned from
<code>tap()</code> or <code>tap(on:_:)</code>, as these methods do not propagate cancellation.

</div>

<p>A <code>TokenPromise</code> is created with the method <code><a href="Structs/Promise.html#/s:12Tomorrowland7PromiseV9withTokenyAA0dB0Vyxq_GAA0b12InvalidationD0VF">Promise.withToken(_:)</a></code>. The wrapped <code><a href="Structs/Promise.html">Promise</a></code> can
be accessed with the <code>.inner</code> property.</p>
<h3 id='example' class='heading'>Example</h3>
<pre class="highlight swift"><code><span class="nf">methodReturningPromise</span><span class="p">()</span>
    <span class="o">.</span><span class="nf">withToken</span><span class="p">(</span><span class="n">promiseToken</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">then</span><span class="p">({</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">in</span>
        <span class="c1">// handle value</span>
    <span class="p">})</span><span class="o">.</span><span class="nf">catch</span><span class="p">({</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="k">in</span>
        <span class="c1">// handle error</span>
    <span class="p">})</span>
</code></pre>

                        <a href="Structs/TokenPromise.html" class="slightly-smaller">See more</a>
                      </div>
                      <div class="declaration">
                        <h4>Declaration</h4>
                        <div class="language">
                          <p class="aside-title">Swift</p>
                          <pre class="highlight swift"><code><span class="kd">public</span> <span class="kd">struct</span> <span class="kt">TokenPromise</span><span class="o">&lt;</span><span class="kt">Value</span><span class="p">,</span> <span class="kt">Error</span><span class="o">&gt;</span></code></pre>

                        </div>
                      </div>
                    </section>
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>
        <section id="footer">
          <p>&copy; 2019 <a class="link" href="https://github.com/lilyball/Tomorrowland" target="_blank" rel="external">Lily Ballard</a>. All rights reserved. (Last updated: 2019-01-28)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.4</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
